---
import { client } from '../../lib/sanityClient.ts'
import { AllPosts } from '../../lib/api.ts'
import Wrapper from '../../components/Wrapper.astro'
import BaseLayout from '../../layouts/BaseLayout.astro'
import BlogSection from '../../components/BlogSection.astro'
import { Post } from '../../types/sanity-types.d.ts'
import BlogPreview from '../../components/BlogPreview.astro'
import Footer from '../../components/Footer.astro'

const title = 'David Huson | Blog'
const description = 'My Blog'
const permalink = 'https://davidhuson.dev/blog'

const allPostData = await client.fetch(AllPosts)
---

<BaseLayout
  title={title}
  description={description}
  permalink={permalink}
  canonicalURL={Astro.canonicalURL.href}
>
  <Wrapper>
    <div>
      <BlogSection>
        {allPostData.map((post: Post) => <BlogPreview post={post} />)}
        {allPostData.map((post: Post) => <BlogPreview post={post} />)}
        {allPostData.map((post: Post) => <BlogPreview post={post} />)}
      </BlogSection>
    </div>
  </Wrapper>
  <Footer />
</BaseLayout>
